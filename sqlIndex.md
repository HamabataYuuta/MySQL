# MySQL インデックスについて

### インデックスとは
- インデックスとは、特定のカラム値のある行のデータを素早く参照したいときに使う。  
テーブルから検索するのではなく、インデックスを検索することで大規模なデータを高速に抽出することができる。
例えば、大量の名前が無造作に入っているカラムを対象にあいうえお順で並び替えたインデックスを作成しておけば、抽出が早くなる。
- データの量が少ないカラムのインデックスを作成しても効果が薄い。

### インデックス情報の確認
- SHOW INDEX構文を使用する。  
`SHOW INDEX FROM テーブル名`    

Cardinalityというカラムが表示される。  
Cardinalityは、ユニークな値や文字を数えて表示されている。  
この数が多いほどインデックスを利用した際の効果が高い。  
レコード数に比べて値や文字の少ないものはインデックスを作成しても効果が薄いということになる。
### インデックスの作成  
- テーブルを作成する時にINDEXを作成  
`CTEATE FROM テーブル名(カラム名 型,INDEX(カラム名))`  
- 既存のテーブルのINDEXを作成  
`CREATE INDEX インデックス名 ON テーブル名(カラム名)` 
カラム名の後にはソートを指定できる。  
### インデックスの削除  
- DROP INDEX構文を使用する。  
`DROP INDEX インデックス名 ON テーブル名`


### インデックスが利用されているかの調査(クエリの実行計画の調査)
- EXPLAINコマンドを使用する。  
- EXPLAINコマンドとは、SELECT句で使用されるテーブルに関する情報を返す。使用する際には、SELECT文の前にEXPLAINを記述する。 
  
  
`EXPLAIN SELECT * FROM film WHERE title ='WORST BANGER';`  

| id | select_type   | table |  type | possible_keys| key          | key_len      | ref          | rows         | extra       |
|:--:|:------------: |:-----:|:-----:|:------------:|:------------:|:------------:|:------------:|:------------:|:------------:|
| 1  |  SIMPLE       | film  | ref   | idx_title    | idex_title   | 767          | const        | 1            |Using index condition

  
- id  
SELECT句の識別子。  
- select_type  
SELECT句の型。  
SIMPLEという表示は、一つのSELECT文という意味で、サブクエリが使用されていないということである。  
- table  
出力行の元のテーブル。
- type  
結合の型。対象のテーブルに対してどのようにアクセスをするのかを示す。  
INDEXが使用されているかどうかを確認することができる。
constは主キーによるアクセス、INDEXによるアクセスを意味しているので、処理が早い。  
refはユニークでないINDEXを使って検索したという意味である。  
- possible_keys  
選択可能なインデックス。
- key   
実際にSELECT句の中で選択したキー。
- key_ren  
選択されたキーの長さ。短いほど処理が早い。
- ref  
インデックスと比較されるカラム。  
検索条件に定数を指定した場合にはconstと表示される。  
テーブル結合をしている場合には結合したテーブルのカラムが表示される。  
- rows  
テーブルから調査された行数。  
- extra  
その他の追加情報。  
Using index conditionはクエリがINDEXだけでデータを抽出できたという意味である。
